{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container mt-4">
  <!-- Top User Section -->
  <div id="topUser" class="card text-center mb-4 shadow-sm">
    <div class="card-body">
      <h5 class="card-title">Loading top user...</h5>
      <p class="card-text text-muted">Please wait while we fetch user data.</p>
    </div>
  </div>

  <!-- All Users Table -->
  <div class="card shadow-sm">
    <div class="card-header bg-light">
      <h5 class="mb-0">All Registered Users</h5>
    </div>
    <div class="card-body">
      <div class="table-responsive">
        <table id="userTable" class="table table-hover align-middle">
          <thead class="table-primary">
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Status</th>
              <th scope="col">Points</th>
            </tr>
          </thead>
          <tbody>
            <!-- Users will be dynamically inserted here -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block head %}
<style>
  body {
    background-color: #f8f9fa;
    font-family: "Poppins", sans-serif;
  }
  .status-child {
    color: #0d6efd;
    font-weight: 500;
  }
  .status-adult {
    color: #6f42c1;
    font-weight: 500;
  }
</style>
{% endblock %}

{% block scripts %}
<script>
  const users = [
    { name: "Alice", status: "child", points: 240 },
    { name: "Bob", status: "adult", points: 180 },
    { name: "Liam", status: "child", points: 290 },
    { name: "Emma", status: "child", points: 150 },
  ];

  users.sort((a, b) => b.points - a.points);

  const topUser = users[0];
  const topUserDiv = document.getElementById("topUser");
  topUserDiv.innerHTML = `
    <div class="card-body">
      <h3 class="card-title">üèÜ ${topUser.name}</h3>
      <p class="card-text mb-1">
        Status: <span class="status-${topUser.status}">${topUser.status}</span>
      </p>
      <p class="card-text">
        <strong>${topUser.points}</strong> points
      </p>
    </div>
  `;

  const tbody = document.querySelector("#userTable tbody");
  users.forEach(user => {
    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${user.name}</td>
      <td class="status-${user.status}">${user.status}</td>
      <td>${user.points}</td>
    `;
    tbody.appendChild(row);
  });
</script>
{% endblock %}
